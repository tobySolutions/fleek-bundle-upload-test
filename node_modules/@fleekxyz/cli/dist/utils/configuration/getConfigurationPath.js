"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getConfigurationPath = void 0;
const errors_1 = require("@fleekxyz/errors");
const fs_1 = require("fs");
const path_1 = require("path");
const getConfigurationPath = async ({ predefinedConfigPath }) => {
    if (predefinedConfigPath) {
        const absolutePath = (0, path_1.join)(process.cwd(), predefinedConfigPath);
        return fs_1.promises
            .access(absolutePath, fs_1.constants.R_OK)
            .then(() => absolutePath)
            .catch(() => Promise.reject(new errors_1.FleekConfigMissingFileError({ configPath: predefinedConfigPath })));
    }
    // Sorted by priority, we return only the first match
    const supposedFilenames = ['fleek.config.ts', 'fleek.config.js', 'fleek.config.json'];
    for (const supposedFilename of supposedFilenames) {
        const absolutePath = (0, path_1.join)(process.cwd(), supposedFilename);
        const isSupposedFileAccessible = await fs_1.promises
            .access(absolutePath, fs_1.constants.R_OK)
            .then(() => true)
            .catch(() => false);
        if (isSupposedFileAccessible) {
            return absolutePath;
        }
    }
    throw new errors_1.FleekConfigMissingFileError({});
};
exports.getConfigurationPath = getConfigurationPath;
//# sourceMappingURL=getConfigurationPath.js.map